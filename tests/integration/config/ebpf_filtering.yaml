# Test-stack override for eBPF filtering.
# This mirrors collector defaults, but broadens ownership roots so CI-safe
# timeout/bash jobs can be linked to live eBPF events.
schema_version: ebpf.filtered.v1

input:
  audit_log: /logs/audit.log
  ebpf_log: /logs/ebpf.jsonl

sessions_dir: /logs/sessions
jobs_dir: /logs/jobs

output:
  jsonl: /logs/filtered_ebpf.jsonl

ownership:
  uid: 1001
  root_comm:
    - codex
    - timeout
  pid_ttl_sec: 0
  exec_keys:
    - exec

exec:
  shell_comm:
    - bash
    - sh
  shell_cmd_flag: "-lc"

include:
  event_types:
    - net_connect
    - net_send
    - dns_query
    - dns_response
    - unix_connect

exclude:
  comm:
    - initd
    - dockerd
    - chown
  unix_paths:
    - /var/run/nscd/socket
    - /var/run/docker.raw.sock
  net_dst_ports: []
  net_dst_ips: []

linking:
  attach_cmd_to_net: true
  attach_cmd_strategy: last_exec_same_pid

pending_buffer:
  enabled: true
  ttl_sec: 1.5
  max_per_pid: 200
  max_total: 2000
